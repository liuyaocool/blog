<!doctype html>
<html>
<head>
    <meta charset="utf-8"/>
    <title>LY`s</title>

    <link rel="stylesheet" href="https://liuyao_cool.gitee.io/jslib/effectjs/wag.css"/>
    <style>
        body, html {
            margin: 0;
            height: 100%;
        }
        #app {
            padding: 10px;
            height: calc(100% - 20px);
        }

        header {
            padding: 2px;
            background-color: rgba(32, 32, 34, 0.9);
        }

        .tag {
            padding: 2px 7px;
            margin: 2px;
            background-color: rgba(50, 50, 51, 1);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 5px;
            box-shadow: rgba(0, 0, 0, 0.075) 0px 1px 1px 0px,
                rgba(0, 0, 0, 0.075) 0px 2px 2px 0px,
                rgba(0, 0, 0, 0.075) 0px 4px 4px 0px,
                rgba(0, 0, 0, 0.075) 0px 8px 8px 0px,
                rgba(0, 0, 0, 0.075) 0px 16px 16px 0px;
        }
        .tag-active {
            background-color: black;
        }
        
        menu {
            background-color: #fbebeb2e;
            box-shadow: #fbf5f59e 0px 0px 8px 0px;
            backdrop-filter: blur(0px);
            padding: 5px 0px;
            z-index: 99;
            font-size: 14px;
            overflow: hidden auto;
            width: fit-content;
            height: fit-content;
            color: white;
            padding: 10px;
        }

        content {
        }
    </style>

    <script>

        // 获取用户代理字符串
        var userAgent = navigator.userAgent;

        // 判断是否为移动设备
        var isMobile = /Mobi/.test(userAgent);

        if (isMobile) {
            // 如果是移动设备
            alert("This is a mobile device");
        }

    </script>
</head>
<body>
    <div id="app">
        <header>
            <button @click="showMenu=!showMenu">三</button>
            <span class="tag" :class="k == showArticlesPath ? 'tag-active' : ''" v-for="(v, k) in articles">{{v[0]}}</span>
        </header>
        <menu v-show="showMenu">
            <ul>
                <li v-for="(item, i) in menu">{{item.name}}
                    <ol>
                        <li v-for="(child, j) in item.child" @click="openArticle(child[0], child[1])">{{child[0]}}</li>
                    </ol>
                </li>
            </ul>
        </menu>
        <div class="content" v-for="(v, k) in articles" v-show="k == showArticlesPath" v-html="v[1]"></div>
    </div>

<script src="https://liuyao_cool.gitee.io/jslib/vue/vue3.global.js"></script>
<script src="https://liuyao_cool.gitee.io/jslib/effectjs/mouseGerm.js"></script>
<script src="https://liuyao_cool.gitee.io/jslib/effectjs/bgRgbDown.js"></script>
<!-- markdown parse -->
<script src="https://liuyao_cool.gitee.io/jslib/markdown/markdown-it.14.0.0.min.js"></script>
<!-- code highlight -->
<script src="https://liuyao_cool.gitee.io/jslib/highlight.11.9.0/highlight.min.js"></script>
<script src="https://liuyao_cool.gitee.io/jslib/highlight.11.9.0/languages/xml.min.js"></script>
<script src="https://liuyao_cool.gitee.io/jslib/highlight.11.9.0/languages/properties.min.js"></script>

<script>
    const {createApp} = Vue;
    const md = markdownit({
        highlight(code, lang, info) {
            let preCode = hljs.getLanguage(lang) ? hljs.highlight(code, { language: lang }).value : code;
            preCode = preCode.split('\n');
            code = '<ol>';
            for (let i = 0; i < preCode.length; i++) {
                code += `<li>${preCode[i]}</li>`;
            }
            return code + '</ol>';
        }
    });
    const vm = createApp({
        data() {
            return {
                menu: [], // articles.json
                showMenu: true,
                showArticlesPath: '',
                // {path: [name, html]}
                articles: {}
            }
        },
        created() {
            getFileText('articles.json', text => this.menu = JSON.parse(text));
        },
        methods: {
            openArticle(name, path) {
                if (!this.articles[path]) {
                    this.articles[path] = [name, '加载中...'];
                    let that = this;
                    getFileText(path, text => that.articles[path][1] = md.render(text));
                }
                this.showArticlesPath = path;
            }
        }
    }).mount('#app');

    function getFileText(path, success) {
        fetch(path).then(resp => {
            if(resp.ok) resp.text().then(str => success(str));
        });
    }
</script>

</body>
</html>